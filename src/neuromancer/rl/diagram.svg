<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.1.0 (20240811.2233)
 -->
<!-- Title: Hybrid_Control_System Pages: 1 -->
<svg width="1592pt" height="322pt"
 viewBox="0.00 0.00 1592.02 321.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 317.8)">
<title>Hybrid_Control_System</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-317.8 1588.02,-317.8 1588.02,4 -4,4"/>
<!-- physical_system -->
<g id="node1" class="node">
<title>physical_system</title>
<path fill="none" stroke="black" d="M96.17,-36C96.17,-36 12,-36 12,-36 6,-36 0,-30 0,-24 0,-24 0,-12 0,-12 0,-6 6,0 12,0 12,0 96.17,0 96.17,0 102.17,0 108.17,-6 108.17,-12 108.17,-12 108.17,-24 108.17,-24 108.17,-30 102.17,-36 96.17,-36"/>
<text text-anchor="middle" x="54.08" y="-13.8" font-family="Times,serif" font-size="14.00">Physical System</text>
</g>
<!-- system_model -->
<g id="node2" class="node">
<title>system_model</title>
<path fill="none" stroke="black" d="M359.71,-125C359.71,-125 214.5,-125 214.5,-125 208.5,-125 202.5,-119 202.5,-113 202.5,-113 202.5,-101 202.5,-101 202.5,-95 208.5,-89 214.5,-89 214.5,-89 359.71,-89 359.71,-89 365.71,-89 371.71,-95 371.71,-101 371.71,-101 371.71,-113 371.71,-113 371.71,-119 365.71,-125 359.71,-125"/>
<text text-anchor="middle" x="287.11" y="-102.8" font-family="Times,serif" font-size="14.00">System Model (ODE/SDE)</text>
</g>
<!-- physical_system&#45;&gt;system_model -->
<g id="edge2" class="edge">
<title>physical_system&#45;&gt;system_model</title>
<path fill="none" stroke="black" d="M102.95,-36.44C139.19,-50.4 189.15,-69.65 227.74,-84.51"/>
<polygon fill="black" stroke="black" points="226.3,-87.71 236.89,-88.04 228.81,-81.18 226.3,-87.71"/>
<text text-anchor="middle" x="155.33" y="-72.03" font-family="Times,serif" font-size="14.00">Modelling</text>
</g>
<!-- data -->
<g id="node3" class="node">
<title>data</title>
<path fill="none" stroke="black" d="M633.32,-56C633.32,-56 528.58,-56 528.58,-56 522.58,-56 516.58,-50 516.58,-44 516.58,-44 516.58,-32 516.58,-32 516.58,-26 522.58,-20 528.58,-20 528.58,-20 633.32,-20 633.32,-20 639.32,-20 645.32,-26 645.32,-32 645.32,-32 645.32,-44 645.32,-44 645.32,-50 639.32,-56 633.32,-56"/>
<text text-anchor="middle" x="580.95" y="-33.8" font-family="Times,serif" font-size="14.00">Time Series Dataset</text>
</g>
<!-- physical_system&#45;&gt;data -->
<g id="edge1" class="edge">
<title>physical_system&#45;&gt;data</title>
<path fill="none" stroke="black" d="M108.53,-14.94C192.05,-10.94 358.47,-6.04 498.58,-21 500.65,-21.22 502.73,-21.47 504.84,-21.74"/>
<polygon fill="black" stroke="black" points="504.28,-25.2 514.68,-23.2 505.3,-18.27 504.28,-25.2"/>
<text text-anchor="middle" x="287.11" y="-16.61" font-family="Times,serif" font-size="14.00">Generate Data</text>
</g>
<!-- system_model&#45;&gt;data -->
<g id="edge3" class="edge">
<title>system_model&#45;&gt;data</title>
<path fill="none" stroke="black" d="M306.77,-88.62C325.8,-71.27 357.1,-46.44 389.71,-36.2 426.54,-24.64 469.38,-24 505.08,-26.73"/>
<polygon fill="black" stroke="black" points="504.62,-30.21 514.89,-27.6 505.23,-23.23 504.62,-30.21"/>
<text text-anchor="middle" x="444.15" y="-40.4" font-family="Times,serif" font-size="14.00">Simulate Data</text>
</g>
<!-- policy_model -->
<g id="node5" class="node">
<title>policy_model</title>
<path fill="none" stroke="black" d="M1572.02,-216C1572.02,-216 1459.49,-216 1459.49,-216 1453.49,-216 1447.49,-210 1447.49,-204 1447.49,-204 1447.49,-192 1447.49,-192 1447.49,-186 1453.49,-180 1459.49,-180 1459.49,-180 1572.02,-180 1572.02,-180 1578.02,-180 1584.02,-186 1584.02,-192 1584.02,-192 1584.02,-204 1584.02,-204 1584.02,-210 1578.02,-216 1572.02,-216"/>
<text text-anchor="middle" x="1515.76" y="-193.8" font-family="Times,serif" font-size="14.00">Policy Model (Actor)</text>
</g>
<!-- system_model&#45;&gt;policy_model -->
<g id="edge14" class="edge">
<title>system_model&#45;&gt;policy_model</title>
<path fill="none" stroke="black" d="M309.9,-125.48C356.3,-162.87 469.69,-244 579.95,-244 579.95,-244 579.95,-244 1244.3,-244 1309.55,-244 1382.43,-230.83 1436.07,-218.58"/>
<polygon fill="black" stroke="black" points="1436.8,-222 1445.74,-216.33 1435.21,-215.18 1436.8,-222"/>
<text text-anchor="middle" x="926.52" y="-248.2" font-family="Times,serif" font-size="14.00">Observation</text>
</g>
<!-- value_model -->
<g id="node6" class="node">
<title>value_model</title>
<path fill="none" stroke="black" d="M1298.39,-139C1298.39,-139 1188.21,-139 1188.21,-139 1182.21,-139 1176.21,-133 1176.21,-127 1176.21,-127 1176.21,-115 1176.21,-115 1176.21,-109 1182.21,-103 1188.21,-103 1188.21,-103 1298.39,-103 1298.39,-103 1304.39,-103 1310.39,-109 1310.39,-115 1310.39,-115 1310.39,-127 1310.39,-127 1310.39,-133 1304.39,-139 1298.39,-139"/>
<text text-anchor="middle" x="1243.3" y="-116.8" font-family="Times,serif" font-size="14.00">Value Model (Critic)</text>
</g>
<!-- system_model&#45;&gt;value_model -->
<g id="edge13" class="edge">
<title>system_model&#45;&gt;value_model</title>
<path fill="none" stroke="black" d="M371.95,-108.23C554.84,-110.91 987.41,-117.26 1164.58,-119.86"/>
<polygon fill="black" stroke="black" points="1164.31,-123.36 1174.36,-120 1164.42,-116.36 1164.31,-123.36"/>
<text text-anchor="middle" x="732.54" y="-118.68" font-family="Times,serif" font-size="14.00">Observation</text>
</g>
<!-- loss_func -->
<g id="node7" class="node">
<title>loss_func</title>
<path fill="none" stroke="black" d="M595.95,-170C595.95,-170 565.95,-170 565.95,-170 559.95,-170 553.95,-164 553.95,-158 553.95,-158 553.95,-146 553.95,-146 553.95,-140 559.95,-134 565.95,-134 565.95,-134 595.95,-134 595.95,-134 601.95,-134 607.95,-140 607.95,-146 607.95,-146 607.95,-158 607.95,-158 607.95,-164 601.95,-170 595.95,-170"/>
<text text-anchor="middle" x="580.95" y="-147.8" font-family="Times,serif" font-size="14.00">Loss</text>
</g>
<!-- system_model&#45;&gt;loss_func -->
<g id="edge4" class="edge">
<title>system_model&#45;&gt;loss_func</title>
<path fill="none" stroke="black" d="M372.13,-119.96C428.31,-128.62 499.52,-139.6 542.31,-146.2"/>
<polygon fill="black" stroke="black" points="541.68,-149.64 552.1,-147.71 542.75,-142.72 541.68,-149.64"/>
<text text-anchor="middle" x="444.15" y="-142.9" font-family="Times,serif" font-size="14.00">Loss Function</text>
</g>
<!-- data&#45;&gt;system_model -->
<g id="edge7" class="edge">
<title>data&#45;&gt;system_model</title>
<path fill="none" stroke="black" d="M516.56,-50.05C470.89,-58.86 413.32,-70.27 389.71,-76.2 378.92,-78.91 367.57,-82.06 356.52,-85.28"/>
<polygon fill="black" stroke="black" points="355.64,-81.89 347.05,-88.09 357.64,-88.6 355.64,-81.89"/>
<text text-anchor="middle" x="444.15" y="-80.4" font-family="Times,serif" font-size="14.00">DPC Training Data</text>
</g>
<!-- nssm -->
<g id="node4" class="node">
<title>nssm</title>
<path fill="none" stroke="black" d="M1021.28,-59C1021.28,-59 831.76,-59 831.76,-59 825.76,-59 819.76,-53 819.76,-47 819.76,-47 819.76,-35 819.76,-35 819.76,-29 825.76,-23 831.76,-23 831.76,-23 1021.28,-23 1021.28,-23 1027.28,-23 1033.28,-29 1033.28,-35 1033.28,-35 1033.28,-47 1033.28,-47 1033.28,-53 1027.28,-59 1021.28,-59"/>
<text text-anchor="middle" x="926.52" y="-36.8" font-family="Times,serif" font-size="14.00">Neural State Space Model (NSSM)</text>
</g>
<!-- data&#45;&gt;nssm -->
<g id="edge6" class="edge">
<title>data&#45;&gt;nssm</title>
<path fill="none" stroke="black" d="M645.77,-38.56C691.24,-38.95 753.69,-39.5 808.05,-39.97"/>
<polygon fill="black" stroke="black" points="807.98,-43.47 818.01,-40.06 808.04,-36.47 807.98,-43.47"/>
<text text-anchor="middle" x="732.54" y="-44.06" font-family="Times,serif" font-size="14.00">NSSM Training Data</text>
</g>
<!-- nssm&#45;&gt;policy_model -->
<g id="edge8" class="edge">
<title>nssm&#45;&gt;policy_model</title>
<path fill="none" stroke="black" d="M1033.41,-39.37C1111.59,-40.94 1219.71,-48.98 1310.39,-77.2 1376.78,-97.86 1444.42,-143.75 1482.83,-172.65"/>
<polygon fill="black" stroke="black" points="1480.67,-175.4 1490.75,-178.68 1484.92,-169.84 1480.67,-175.4"/>
<text text-anchor="middle" x="1243.3" y="-81.4" font-family="Times,serif" font-size="14.00">Augment Inputs</text>
</g>
<!-- nssm&#45;&gt;value_model -->
<g id="edge9" class="edge">
<title>nssm&#45;&gt;value_model</title>
<path fill="none" stroke="black" d="M1033.55,-53.09C1082.61,-59.43 1135.08,-67.46 1158.21,-75.2 1174.19,-80.55 1190.71,-88.85 1204.82,-96.92"/>
<polygon fill="black" stroke="black" points="1202.94,-99.87 1213.33,-101.94 1206.5,-93.84 1202.94,-99.87"/>
<text text-anchor="middle" x="1104.74" y="-79.4" font-family="Times,serif" font-size="14.00">Augment Inputs</text>
</g>
<!-- policy_model&#45;&gt;system_model -->
<g id="edge5" class="edge">
<title>policy_model&#45;&gt;system_model</title>
<path fill="none" stroke="black" d="M1493.8,-216.43C1477.38,-229.92 1453.39,-247.6 1429.49,-258 1352.36,-291.56 1328.41,-297 1244.3,-297 579.95,-297 579.95,-297 579.95,-297 493.64,-297 461.41,-306.04 389.71,-258 344.71,-227.84 314.41,-170.35 299.31,-135.67"/>
<polygon fill="black" stroke="black" points="302.63,-134.53 295.53,-126.67 296.17,-137.24 302.63,-134.53"/>
<text text-anchor="middle" x="926.52" y="-301.2" font-family="Times,serif" font-size="14.00">Decision Making</text>
</g>
<!-- value_model&#45;&gt;policy_model -->
<g id="edge15" class="edge">
<title>value_model&#45;&gt;policy_model</title>
<path fill="none" stroke="black" d="M1310.75,-135.84C1346.23,-144.2 1390.5,-155.33 1429.49,-167.2 1437.96,-169.78 1446.82,-172.71 1455.5,-175.72"/>
<polygon fill="black" stroke="black" points="1454.33,-179.01 1464.92,-179.04 1456.65,-172.41 1454.33,-179.01"/>
<text text-anchor="middle" x="1378.94" y="-171.4" font-family="Times,serif" font-size="14.00">Optimize by DRL</text>
</g>
<!-- loss_func&#45;&gt;policy_model -->
<g id="edge11" class="edge">
<title>loss_func&#45;&gt;policy_model</title>
<path fill="none" stroke="black" d="M608.41,-160.36C624.18,-164.96 644.7,-170.27 663.32,-173 732.17,-183.09 750.22,-176.72 819.76,-179 1043.14,-186.34 1306.97,-193 1435.87,-196.13"/>
<polygon fill="black" stroke="black" points="1435.58,-199.62 1445.66,-196.36 1435.75,-192.62 1435.58,-199.62"/>
<text text-anchor="middle" x="1104.74" y="-193.15" font-family="Times,serif" font-size="14.00">Optimize by DPC</text>
</g>
<!-- reward_func -->
<g id="node8" class="node">
<title>reward_func</title>
<path fill="none" stroke="black" d="M944.29,-170C944.29,-170 908.75,-170 908.75,-170 902.75,-170 896.75,-164 896.75,-158 896.75,-158 896.75,-146 896.75,-146 896.75,-140 902.75,-134 908.75,-134 908.75,-134 944.29,-134 944.29,-134 950.29,-134 956.29,-140 956.29,-146 956.29,-146 956.29,-158 956.29,-158 956.29,-164 950.29,-170 944.29,-170"/>
<text text-anchor="middle" x="926.52" y="-147.8" font-family="Times,serif" font-size="14.00">Reward</text>
</g>
<!-- loss_func&#45;&gt;reward_func -->
<g id="edge10" class="edge">
<title>loss_func&#45;&gt;reward_func</title>
<path fill="none" stroke="black" d="M608.34,-152C668.18,-152 814.46,-152 885.5,-152"/>
<polygon fill="black" stroke="black" points="885.12,-155.5 895.12,-152 885.12,-148.5 885.12,-155.5"/>
<text text-anchor="middle" x="732.54" y="-156.2" font-family="Times,serif" font-size="14.00">Loss(DPC) &#45; Loss(DRL)</text>
</g>
<!-- reward_func&#45;&gt;value_model -->
<g id="edge12" class="edge">
<title>reward_func&#45;&gt;value_model</title>
<path fill="none" stroke="black" d="M956.57,-149.14C1003.4,-144.53 1097.14,-135.3 1164.5,-128.66"/>
<polygon fill="black" stroke="black" points="1164.79,-132.15 1174.4,-127.69 1164.1,-125.18 1164.79,-132.15"/>
<text text-anchor="middle" x="1104.74" y="-143.48" font-family="Times,serif" font-size="14.00">Cumulative Return</text>
</g>
</g>
</svg>
