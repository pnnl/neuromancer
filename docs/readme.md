# Documentation Process 

Documentation is configured in `./docs`.
+ The behavior of sphinx is configured by `./docs/conf.py`.
+ The rst files govern the subpages that are included. 


Documentation is built and deployed to gh-pages branch
(https://pnnl.github.io/neuromancer/) automatically on merge with master
branch.

**The gh-pages branch of the NeuroMANCER repository contains nothing but the documentation html files.** 
Github hosts this branch as a webpage at (https://pnnl.github.io/neuromancer/).

There is also a manual process you may use to build documentation, requiring
a second copy of the repository with the gh-pages branch checked out.


## The Automatic Process

On a push to the master branch, a Github Actions (GHA) script found
at `./github/workflows/update_docs.yml` is executed, building the documentation
with sphinx (`./docs` is the source directory for this build) and pushing the output to the `gh-pages` branch.

## A Manual Process 

### Make a 2nd Copy of the Repository

This 2nd repo copy is the target for the built documentation files.

On the same level as your Neuromancer repo, make a docs directory and then
clone the gh-pages branch of the repo at github.com/pnnl/neuromancer.

```bash

$ mkdir ../docs; cd ../docs
$ git clone https://github.com/pnnl/neuromancer.git -b gh-pages --single-branch
$ mv neuromancer html

```

The directory structure should now be
```
..
├── docs
│   └── html    <- 2nd repo (neuromancer gh-branch)
└── neuromancer <- 1st repo (neuromancer)
    ├── LICENSE.md
    ├── README.md
    ├── docs 
    ...
```


### From the 1st Copy,


You will want to install sphinx in order to autogenerate the documentation

```bash

$ conda activate neuromancer
$ conda install sphinx -c anaconda
$ conda install -c conda-forge sphinx_rtd_theme

```

We'll now navigate to the `docs` directory in the first repository

``` bash
$ cd ../neuromancer/docs
```

Here, we'll run the makefile to that generates the html docs.
**This make file uses the 2nd copy of the repository as its build directory**


```bash

$ make html

```

Now navigate to the gh-pages branch you cloned (now called html instead of
neuromancer). Take a look at the generated documentation by loading index.html
in your browser. If everything looks good then add, commit, and push to the
repo. 

```bash

$ cd ../../docs/html
$ git add *.html; git add objects.inv; git add search_index.js
$ git commit -m 'Added new documentation for NM version x.xx'
$ git push origin gh-pages

```

## Organization

```
.
├── Makefile
├── _static                <- manual HTML links look here 
│    └── Neuromancer.ico
├── _templates             <- jinja templates
│   ├── autosummary
│   │   ├── class.rst
│   │   └── module.rst
│   └── layout.html
├── conf.py                <- configure sphinx here
├── copied                 <- contents copied to build directory 
│   └── figs
│       ├── class_diagram.png
│       └── Neuromancer.png
├── index.rst              <- gets converted to index.html
│                             contains directive to autogenerate docs from
│                             neuromancer source code
├── generated 
│   └── ...                <- recursively autogenerated stubs 
│
├── make.bat  <- obsolete?
├── readme.md              <- the file you're currently reading
└── slim      <- obsolete? 
    ├── _static
    │   ├── draw.png
    │   ├── icann2001predict.pdf
    │   ├── make_icon.ipynb
    │   ├── slim.ico
    │   └── slim.png
    └── index.rst

```

